{extend name="common:base" /}
{block name="style"}
<style type="text/css">
.table>thead>tr>th {
    text-align: center;
}

.fant {
    font-weight: 600;
}
</style>
{/block}
{block name="content"}
<div class="ibox-content m-b-sm border-bottom">
    <div class="row">
            <form  method="get" action="{:url()}">
        <div class="col-sm-4">
            <div class="form-group">
                <label class="control-label" for="product_name">会员信息</label>
                <input type="text" id="realname" name="realname" value="{$kw}" placeholder="可搜索会员昵称/姓名/手机号" class="form-control">
            </div>
        </div>

        <div class="col-sm-4">
            <div class="form-group">
                <label class="control-label" for="price">充值单号</label>
                <input type="text" id="logno" name="logno" value="{$logno}" placeholder="可搜索充值单号" class="form-control">
            </div>
        </div>

        <div class="col-sm-4">
            <div class="form-group">
                <label class="control-label" for="status">会员等级</label>
                <select name='level' class='form-control' style="width:150px;">
                    <option value=''>默认全部</option>
                    {foreach $levels as $key => $vo}
                    <option value='{$key}' {if $level==$vo['id']}selected{/if}>{$vo['levelname']}</option>
                    {/foreach}
                </select>
            </div>
        </div>

        <div class="col-sm-4">
            <div class="form-group">
                <label class="control-label" for="status">会员分组</label>
                    <select name='groupid' class='form-control' style="width:150px;">
                        <option value=''>默认全部</option>
                        {foreach $groups as $key => $vo}
                        <option value='{$key}' {if $groupid==$vo['id']}selected{/if}>{$vo['groupname']}</option>
                        {/foreach}
                     </select>
            </div>
        </div>

        <div class="col-sm-4">
            <div class="form-group">
                <label class="control-label" for="status">状态</label>
                <select name="status" id="status" class="form-control">
                    <option value='' {if $status==''}selected{/if}></option>
                    <option value='1' {if $status=='1'}selected{/if}>充值成功</option>
                    <option value='0' {if $status=='0'}selected{/if}>未充值</option>
                </select>
            </div>
        </div>

        <div class="col-sm-4">
            <div class="form-group">
                <label class="control-label" for="status">充值方式</label>
                <select name="status" id="status" class="form-control">
                    <option value='' {if $rechargetype==''}selected{/if}></option>
                    <option value='wechat' {if $rechargetype=='wechat'}selected{/if}>微信</option>
                    <option value='alipay' {if $rechargetype=='alipay'}selected{/if}>支付宝</option>
                    <option value='system' {if $rechargetype=='system'}selected{/if}>后台</option>
                    <option value='system1' {if $rechargetype=='system1'}selected{/if}>后台扣款</option>
                </select>
            </div>
        </div>

        <div class="col-sm-4">
            <div class="form-group">
                <label class="control-label">日期</label>
                <div class="input-daterange input-group" data-provide="datepicker">
                    <input class="form-control input-sm" name="begin_time" type="text" value="{$begin_time}"/>
                     <span class="input-group-addon">到</span>
                    <input class="form-control input-sm" name="end_time" type="text" value="{$end_time}"/>
                </div>
            </div>
        </div>

        <div class="col-sm-2">
            <div class="form-group">
                <label class="control-label" for="status">　</label>
                <div>
                    <button class="btn btn-primary">查询</button>
                </div>
            </div>
        </div>

    </div>
</form>
</div>

<div class="row wrapper border-bottom white-bg page-heading">
       
        <div class="col-lg-2">

        </div>

        <div class="ibox-content">
                <div class="table-responsive">
                    <table class="table  table-bordered table-hover text-center">
                        <thead>
                            <tr>
                                <th>充值单号</th>
                                <th class="col-lg-2">粉丝</th>
                                <th>会员信息</th>
                                <th>微信号</th>
                                <th>会员等级</th>
                                <th>会员分组</th>
                                <th>充值金额</th>
                                <th>充值时间</th>
                                <th>充值方式</th>
                                <th>状态</th>
                                <th>操作</th>
                            </tr>
                        </thead> 
                        <tbody>
                            {notempty name="list"}
                            {volist name="list" id="row"}
                            <tr>
                                <td>{if !empty($row['logno'])}
                                    {if strlen($row['logno'])<=22}
                                    {$row['logno']}
                                    {else/}
                                    recharge{$row['id']}
                                    {/if}
                             {else /}
                             recharge{$row['id']}
                             {/if}</td>
                                <td><a href="{:url('member/member_detail',array('id' => $row['mid']));}" style="color: #003CB3;"><img src='{$row['avatar']}' style='width:30px;height:30px;padding1px;border:1px solid #ccc' /> {$row['nickname']}</a></td>
                                <td>{$row['realname']}<br/>{$row['mobile']}</td>
                                <td   class='hidden-xs'>{$row['weixin']}</td>
                                <td   class='hidden-xs'>{if empty($row['levelname'])}普通会员{else/}{$row['levelname']}{/if}</td>
                                <td   class='hidden-xs'>{if empty($row['groupname'])}无分组{else/}{$row['groupname']}{/if}</td>
                                <td>{$row['money']}</td>
                                <td>{$row['createtime']|date="y-m-d H:i:s",###}</td>  
                                <td>{if $row['rechargetype']=='alipay'}
                                        <span class='label label-warning'>支付宝</span>
                                    {elseif $row['rechargetype']=='wechat' /}
                                        <span class='label label-success'>微信</span>
                                    {elseif $row['rechargetype']=='system' /}
                                        {if $row['money'] >0 }
                                            <span class='label label-primary'>后台</span>
                                        {else/}
                                            <span class='label label-default'>后台扣款</span>
                                        {/if}
                                    {elseif $row['rechargetype']=='withdrawal'}
                                            <span class='label label-primary'>分销佣金转入</span>
                                    {elseif $row['rechargetype']=='bonus'/}
                                            <span class='label label-primary'>分红佣金转入</span>
                                    {elseif $row['rechargetype']=='article'/}
                                            <span class='label label-primary'>分享文章</span>
                                    {elseif $row['rechargetype']=='evm'/}
                                            <span class='label label-primary'>二维码扫描</span>
                                    {elseif $row['rechargetype']=='backmoney'/}
                                            <span class='label label-primary'>充值优惠券返利</span>
                                    {elseif $row['rechargetype']=='premium'/}
                                            <span class='label label-primary'>新三级分销返利</span>
                                    {elseif $row['rechargetype']=='buy_backmoney'/}
                                            <span class='label label-primary'>购物优惠券返利</span>
                                    {elseif $row['rechargetype']=='all_bonus'/}
                                            <span class='label label-primary'>全球分红返利</span>
                                    {elseif $row['rechargetype']=='r_each'/}
                                            <span class='label label-primary'>排位返现</span>
                                    {elseif $row['rechargetype']=='order'/}
                                            <span class='label label-primary'>商家供应货款</span>
                                    {elseif $row['rechargetype']=='bonusplus'/}
                                            <span class='label label-primary'>静态分红返利</span>        
                                    {/if}
                                </td>
                                <td>{if $row['status']==0}
                                    <span class='label label-default'>{if $row['type']==1}申请中{else/}未充值{/if}</span>
                                    {elseif $row['status']==1/}
                                    <span class='label label-success'>{if $row['type']==1}成功{else/}充值成功{/if}</span>
                                    {elseif $row['status']==-1/}
                                    <span class='label label-warning'>{if $row['type']==-1}失败{/if}</span>
                                    {elseif $row['status']==3/}
                                    <span class='label label-danger'>{if $row['type']==0}充值退款{/if}</span>
                                    {/if}
                                </td> 
                                
                                <td>
                                    <a class='btn btn-default' href="{:url('member/member_edit',array('id' => $row['mid']));}" style="background-color: #7DBAEF; color: #fff;">用户信息</a>		
                                    {if $row['type']==0 && $row['status']==1}
                                    {if $row['rechargetype']=='alipay' || $row['rechargetype']=='wechat'}
                                          <a class='btn btn-danger' onclick="return confirm('确认退款到微信钱包?')" href="{:url('finance/log',array('op'=>'pay','paytype'=>'refund','id' => $row['id']));}">退款</a>		         
                                    {/if}
                                    {/if}
                                    {if $row['type']==1 && $row['status']==0}
                                        <a class='btn btn-default' onclick="return confirm('确认微信钱包提现?')" href="{:url('finance/log',array('op'=>'pay','paytype'=>'wechat','id' => $row['id']));}" style="background-color: #ffb034; color:#fff;">微信提现</a><br />	
                                        <a class='btn btn-default' onclick="return confirm('确认手动提现完成?')" href="{:url('finance/log',array('op'=>'pay','paytype'=>'manual','id' => $row['id']));}" style=" margin-top: 6px; background-color: #ff5858; color:#fff;">手动提现</a><br />
                                        <a class='btn btn-default' onclick="return confirm('确认拒绝提现申请?')" href="{:url('finance/log',array('op'=>'pay','paytype'=>'refuse','id' => $row['id']));}" style=" margin-top: 6px; background-color: #000; color:#fff;">拒绝</a><br />
                                    {/if}
                                </td>
                            </tr>
                            {/volist}
                            {/notempty}
                        </tbody>
                    </table>
                    {$list->render()}
                </div>
            </div>
    </div>
{/block}